<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Adding recharge classes &mdash; GWTSA 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="GWTSA 0.0.1 documentation" href="../index.html" /> 
  </head>
  <body role="document">
<div class="header">
<a href="../index.html"><img src="../_static/logo.png" border="0" alt="GWTSA Logo" height="100px"></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">Home</a>|&nbsp;</li>
        <li><a href="../search.html">Search</a>|&nbsp;</li>
        <li><a href="../examples.html">Examples</a>|&nbsp;</li>
       <li><a href="../content.html">Documentation </a> |&nbsp;</li>
       <li><a href="../developers.html">Developers </a> |&nbsp;</li>

 
      </ul>
    </div>

<div class="sidebar">
      <div class="sphinxsidebar">
          <div class="sphinxsidebarwrapper">
              <h3><a href="#">Project Info</a></h3>
              <p>Version:<b> 0.0.1 </b></p>
              <a href="https://travis-ci.org/gwtsa/gwtsa"><img
        src="https://travis-ci.org/gwtsa/gwtsa.svg?branch=master" border="0"
        alt="Travis Status">
              </a>
          </div>
      </div>
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Adding recharge classes</a></li>
<li><a class="reference internal" href="#the-recharge-func-py-classes">The recharge_func.py classes</a></li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/developers/add_recharge.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
</div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="adding-recharge-classes">
<h1>Adding recharge classes<a class="headerlink" href="#adding-recharge-classes" title="Permalink to this headline">¶</a></h1>
<p>the recharge class is developed specifically for the simulation of groundwater,
with different options to calculate the groundwater recharge. The base of the
recharge models is a <cite>Recharge</cite> class in tseries.py. This class takes two
stresses: (potential) evaporation and precipitation, and uses a recharge function
to calculate a recharge stress from these two input stresses. Finally, the
calculated recharge series is convoluted with a response function to calculate
the contribution to the groundwater heads. the parameters for both the response
function and recharge model are optimized simultaneously this way.</p>
<p>In this section it is described how to add a recharge class to calculate the
recharge. The actual functions to calculate the recharge are contained in the
<cite>recharge</cite> folder. Within this folder, two files are important to take a look at:
<cite>recharge_func.py</cite> and <cite>recharge.py</cite>. The first contains a class for each
recharge model (similar to the classes in rfunc.py) and the second contains the
computational core to calculate recharge series. The other files are solutions
to reduce computation times but we&#8217;ll come back to those.</p>
<ul class="simple">
<li>Please take a look at the Recharge example notebook!*</li>
</ul>
</div>
<div class="section" id="the-recharge-func-py-classes">
<h1>The recharge_func.py classes<a class="headerlink" href="#the-recharge-func-py-classes" title="Permalink to this headline">¶</a></h1>
<p>The classes defined in this file are the classes that are provided when a
Recharge tseries object is created. E.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">Recharge</span><span class="p">(</span><span class="n">precip</span><span class="p">,</span> <span class="n">evap</span><span class="p">,</span> <span class="n">Gamma</span><span class="p">(),</span> <span class="n">Preferential</span><span class="p">())</span>
</pre></div>
</div>
<p>In this section we will have a closer look at the Preferential() class.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Preferential</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Preferential flow recharge model</span>

<span class="sd">    The water balance for the root zone is calculated as:</span>
<span class="sd">    dS / dt = Pe * (1 - (Sr / Srmax)**Beta)- Epu * min(1, Sr / (0.5 * Srmax))</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nparam</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Has to be 1 right now.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># 1 = implicit, 2 = explicit</span>

    <span class="k">def</span> <span class="nf">set_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">,</span> <span class="s1">&#39;pmin&#39;</span><span class="p">,</span> <span class="s1">&#39;pmax&#39;</span><span class="p">,</span> <span class="s1">&#39;vary&#39;</span><span class="p">])</span>
        <span class="n">parameters</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_Srmax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.26</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">parameters</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_Beta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">parameters</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_Imax&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.5e-3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">parameters</span>

    <span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">precip</span><span class="p">,</span> <span class="n">evap</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">precip</span><span class="p">))</span>
        <span class="n">recharge</span> <span class="o">=</span> <span class="n">pref</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">precip</span><span class="p">,</span> <span class="n">evap</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">recharge</span>
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>

      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">Home</a>|&nbsp;</li>
        <li><a href="../search.html">Search</a>|&nbsp;</li>
        <li><a href="../examples.html">Examples</a>|&nbsp;</li>
       <li><a href="../content.html">Documentation </a> |&nbsp;</li>
       <li><a href="../developers.html">Developers </a> |&nbsp;</li>

 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, M. Bakker, R.A. Collenteur, R. Calje, F. Schaars.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>